<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>Hackergame 2022 题解 - Ramen's Box</title><meta name=Description content="Ramen's stuff box"><meta property="og:title" content="Hackergame 2022 题解"><meta property="og:description" content="今年又来了，由于这次很多题目 fuzz 部分非常多，本拍脑袋选手蒙出来不少可以做的东西，分数+排名都比去年好了很多，很开心。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.lxdlam.com/post/6918ebb9/"><meta property="og:image" content="https://blog.lxdlam.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-10-28T02:14:47+08:00"><meta property="article:modified_time" content="2023-01-04T02:01:57+08:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.lxdlam.com/logo.png"><meta name=twitter:title content="Hackergame 2022 题解"><meta name=twitter:description content="今年又来了，由于这次很多题目 fuzz 部分非常多，本拍脑袋选手蒙出来不少可以做的东西，分数+排名都比去年好了很多，很开心。"><meta name=application-name content="Ramen's Box"><meta name=apple-mobile-web-app-title content="Ramen's Box"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.lxdlam.com/post/6918ebb9/><link rel=prev href=https://blog.lxdlam.com/post/24e3aa77/><link rel=next href=https://blog.lxdlam.com/post/8a92c50b/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="UA-92306989-1"><meta name=baidu-site-verification content="092774cb717e6851abd2d7fc55835b40"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Hackergame 2022 题解","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.lxdlam.com\/post\/6918ebb9\/"},"image":["https:\/\/blog.lxdlam.com\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"Hackergame, Web, 逆向, 数学, CTF","wordcount":5723,"url":"https:\/\/blog.lxdlam.com\/post\/6918ebb9\/","datePublished":"2022-10-28T02:14:47+08:00","dateModified":"2023-01-04T02:01:57+08:00","license":"本站所有内容基于署名-非商业性使用-相同方式共享 4.0 国际协议（CC BY-NC-SA 4.0）给出许可","publisher":{"@type":"Organization","name":"Ramen","logo":"https:\/\/blog.lxdlam.com\/images\/avatar.png"},"author":{"@type":"Person","name":"Ramen"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Ramen's Box"><span class=header-title-pre><i class='fas fa-star'></i></span>Ramen's Box</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Ramen's Box"><span class=header-title-pre><i class='fas fa-star'></i></span>Ramen's Box</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">Hackergame 2022 题解</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://blog.lxdlam.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Ramen</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E8%B6%A3%E9%A2%98%E8%AE%B0%E5%BD%95/><i class="far fa-folder fa-fw" aria-hidden=true></i>趣题记录</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2022-10-28>2022-10-28</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 5723 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 12 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#签到>签到</a></li><li><a href=#猫咪问答喵>猫咪问答喵</a></li><li><a href=#家目录里的秘密>家目录里的秘密</a><ul><li><a href=#vs-code-里的-flag>VS Code 里的 flag</a></li><li><a href=#rclone-里的-flag>Rclone 里的 flag</a></li></ul></li><li><a href=#heilang>HeiLang</a></li><li><a href=#xcaptcha>Xcaptcha</a></li><li><a href=#旅行照片-20>旅行照片 2.0</a><ul><li><a href=#图片分析>图片分析</a></li><li><a href=#社工入门>社工入门</a></li></ul></li><li><a href=#猜数字>猜数字</a></li><li><a href=#latex-机器人>LaTeX 机器人</a><ul><li><a href=#纯文本>纯文本</a></li><li><a href=#特殊字符混入>特殊字符混入</a></li></ul></li><li><a href=#flag-的痕迹>Flag 的痕迹</a></li><li><a href=#安全的在线测评>安全的在线测评</a><ul><li><a href=#无法-ac-的题目>无法 AC 的题目</a></li><li><a href=#动态数据>动态数据</a></li></ul></li><li><a href=#线路板>线路板</a></li><li><a href=#flag-自动机>Flag 自动机</a></li><li><a href=#微积分计算小练习>微积分计算小练习</a></li><li><a href=#杯窗鹅影>杯窗鹅影</a><ul><li><a href=#flag1>flag1</a></li><li><a href=#flag2>flag2</a></li></ul></li><li><a href=#蒙特卡罗轮盘赌>蒙特卡罗轮盘赌</a></li><li><a href=#惜字如金>惜字如金</a><ul><li><a href=#hs384>HS384</a></li></ul></li><li><a href=#置换魔群>置换魔群</a><ul><li><a href=#置换群上的-rsa>置换群上的 RSA</a></li><li><a href=#置换群上的-dh>置换群上的 DH</a></li></ul></li><li><a href=#光与影>光与影</a></li><li><a href=#链上记忆大师>链上记忆大师</a><ul><li><a href=#记忆练习>记忆练习</a></li></ul></li><li><a href=#片上系统>片上系统</a><ul><li><a href=#引导扇区>引导扇区</a></li></ul></li><li><a href=#看不见的彼方>看不见的彼方</a></li><li><a href=#量子藏宝图>量子藏宝图</a></li><li><a href=#企鹅拼盘>企鹅拼盘</a><ul><li><a href=#这么简单我闭眼都可以>这么简单我闭眼都可以</a></li><li><a href=#大力当然出奇迹啦>大力当然出奇迹啦~</a></li></ul></li><li><a href=#火眼金睛的小-e>火眼金睛的小 E</a><ul><li><a href=#有手就行>有手就行</a></li></ul></li></ul></nav></div></div><div class=content id=content><p>今年又来了，由于这次很多题目 fuzz 部分非常多，本拍脑袋选手蒙出来不少可以做的东西，分数+排名都比去年好了很多，很开心。</p><h2 id=签到>签到</h2><p>我点进去的时候网比较烂，只看到一个提交按钮，点了下发现 url 有个 <code>result=????</code> 的 query，试了试 2022 就过了。</p><p>后面我又点进去才知道是 wasm 搞了个 MNIST，还挺牛。</p><h2 id=猫咪问答喵>猫咪问答喵</h2><p>比去年难多了。</p><ol><li>搜索。</li><li>听力考试，凭借我强大的脑补能力猜出来了是 Kdenlive。</li><li>直接搜 &ldquo;firefox windows 2000&rdquo;，有用户说 28 也能跑，试了下不对，官方支持是 12，改成 12 就对了。</li><li>搜索 &ldquo;kernel argc non zero&rdquo;，能找到 LWN.net 的<a href=https://lwn.net/Articles/882799/ target=_blank rel="noopener noreffer">讨论</a>，从下面找到核心 patch 的修改点然后直接去 Github 找到 kernel 的 <code>fs/exec.c</code> <a href=https://github.com/torvalds/linux/blob/master/fs/exec.c#L1900 target=_blank rel="noopener noreffer">文件</a> 对应位置，<code>git blame</code> 一下拿到 commit hash。</li><li>找了很久，最后在 Github <a href=cs.github.com rel>代码搜索</a> 搜 hash，搜到个 ip，点进去一看域名确实是。</li><li>搜索“网络通”，从 FAQ 里面看到这个通知的名字是 《中国科学技术大学校园网络运行及通信费用分担办法》，搜索这个关键词，从中科大网络信息中心的<a href=https://ustcnet.ustc.edu.cn/2001/0409/c11109a210875/page.htm target=_blank rel="noopener noreffer">文件扫描页面</a>发现这种文件都是网字头，顺着找一下就能找到正式施行的文件，拿到时间。</li></ol><h2 id=家目录里的秘密>家目录里的秘密</h2><h3 id=vs-code-里的-flag>VS Code 里的 flag</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>grep -ir <span class=s1>&#39;flag&#39;</span> ./*
</span></span></code></pre></td></tr></table></div></div><h3 id=rclone-里的-flag>Rclone 里的 flag</h3><p><code>/home/user/.config/rclone/rclone.conf</code> 里面有个 pass，不知道是啥，搞个 rclone 源码审计了一下，发现有个 <code>obscure</code> 命令，然后下面刚好有个 <code>Reveal</code> 函数，直接 copy 出来跑一遍就出 flag 了。</p><h2 id=heilang>HeiLang</h2><p><code>%s/|/,/g</code>，然后把前面的实现改成：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>class</span> <span class=nc>A</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>a</span> <span class=o>=</span> <span class=p>[</span><span class=mi>0</span><span class=p>]</span> <span class=o>*</span> <span class=mi>10000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__setitem__</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>idx</span><span class=p>,</span> <span class=n>val</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=nb>int</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>[</span><span class=n>idx</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=nb>isinstance</span><span class=p>(</span><span class=n>idx</span><span class=p>,</span> <span class=nb>tuple</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>item</span> <span class=ow>in</span> <span class=n>idx</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>a</span><span class=p>[</span><span class=n>item</span><span class=p>]</span> <span class=o>=</span> <span class=n>val</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># a = [0] * 10000</span>
</span></span><span class=line><span class=cl><span class=n>a</span> <span class=o>=</span> <span class=n>A</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>get_flag</span><span class=p>(</span><span class=n>a</span><span class=o>.</span><span class=n>a</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><p>直接跑就出结果了。</p><h2 id=xcaptcha>Xcaptcha</h2><p>打开点进去，页面一闪而过，用 requests + BeautifulSoup 交互式 parse 一下页面，然后把答案提交了就行。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>requests</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>bs4</span> <span class=kn>import</span> <span class=n>BeautifulSoup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>URL</span> <span class=o>=</span> <span class=s2>&#34;http://202.38.93.111:10047&#34;</span>
</span></span><span class=line><span class=cl><span class=n>TOKEN</span> <span class=o>=</span> <span class=s2>&#34;&#34;&#34;&lt;Your Token&gt;&#34;&#34;&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=n>requests</span><span class=o>.</span><span class=n>session</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=n>URL</span><span class=p>,</span> <span class=n>params</span><span class=o>=</span><span class=p>{</span><span class=s2>&#34;token&#34;</span><span class=p>:</span> <span class=n>TOKEN</span><span class=p>})</span>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>get</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>URL</span><span class=si>}</span><span class=s2>/xcaptcha&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>soup</span> <span class=o>=</span> <span class=n>BeautifulSoup</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>,</span> <span class=n>features</span><span class=o>=</span><span class=s2>&#34;html.parser&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>answers</span> <span class=o>=</span> <span class=nb>map</span><span class=p>(</span><span class=k>lambda</span> <span class=n>x</span><span class=p>:</span> <span class=nb>eval</span><span class=p>(</span><span class=n>x</span><span class=o>.</span><span class=n>string</span><span class=o>.</span><span class=n>rstrip</span><span class=p>(</span><span class=s2>&#34; 的结果是？&#34;</span><span class=p>)),</span>
</span></span><span class=line><span class=cl>                  <span class=n>soup</span><span class=o>.</span><span class=n>findAll</span><span class=p>(</span><span class=s2>&#34;label&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{}</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>answer</span> <span class=ow>in</span> <span class=nb>enumerate</span><span class=p>(</span><span class=n>answers</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span><span class=p>[</span><span class=sa>f</span><span class=s2>&#34;captcha</span><span class=si>{</span><span class=n>idx</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>]</span> <span class=o>=</span> <span class=n>answer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>r</span> <span class=o>=</span> <span class=n>s</span><span class=o>.</span><span class=n>post</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;</span><span class=si>{</span><span class=n>URL</span><span class=si>}</span><span class=s2>/xcaptcha&#34;</span><span class=p>,</span> <span class=n>data</span><span class=o>=</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>r</span><span class=o>.</span><span class=n>text</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=旅行照片-20>旅行照片 2.0</h2><h3 id=图片分析>图片分析</h3><p>下载下来直接右键 -> 显示简介，答案都在上面。</p><h3 id=社工入门>社工入门</h3><ul><li><p>酒店</p><ol><li>放大图片能看到 <em>WELCOME TO ZOZOMARINE STADIUM</em>，搜了下在日本千叶，虽然根据方位 Google Map 显示了三个可能的酒店，但是这一街区的邮编都是一个。</li><li>EXIF 信息看到这个设备是 <em>Xiaomi sm6115 (juice)</em>，国内版本型号是红米 Note 9 4G，随便找个 spec 就能找到分辨率了，长宽别写反了。</li></ol></li><li><p>航班</p><p>因为担心改航线，搜了好几个能看历史航班信息的，找了个便宜的开了个 7 天试用，比划半天找到了。<del>（事后想了想，反正是免费试用，找便宜的意义在哪儿？）</del></p></li></ul><h2 id=猜数字>猜数字</h2><p>一开始是猜可能要多线程撞 <code>ConcurrentHashMap</code> 或者是 XML Encoding 上搞些花活，最后发现：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=n>var</span> <span class=n>guess</span> <span class=o>=</span> <span class=n>Double</span><span class=o>.</span><span class=na>parseDouble</span><span class=o>(</span><span class=n>event</span><span class=o>.</span><span class=na>asCharacters</span><span class=o>().</span><span class=na>getData</span><span class=o>());</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>isLess</span> <span class=o>=</span> <span class=n>guess</span> <span class=o>&lt;</span> <span class=k>this</span><span class=o>.</span><span class=na>number</span> <span class=o>-</span> <span class=mf>1e-6</span> <span class=o>/</span> <span class=mi>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>isMore</span> <span class=o>=</span> <span class=n>guess</span> <span class=o>&gt;</span> <span class=k>this</span><span class=o>.</span><span class=na>number</span> <span class=o>+</span> <span class=mf>1e-6</span> <span class=o>/</span> <span class=mi>2</span><span class=o>;</span>
</span></span><span class=line><span class=cl><span class=n>var</span> <span class=n>isPassed</span> <span class=o>=</span> <span class=o>!</span><span class=n>isLess</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=n>isMore</span><span class=o>;</span>
</span></span></code></pre></td></tr></table></div></div><p>根据 IEEE 754 标准，<code>NaN</code> 上的一切比较都是 <code>false</code>，这里的答案解析方式是接受 <code>NaN</code> 的，而 <code>NaN</code> 后 <code>isLess</code> 和 <code>isMore</code> 就恒为 <code>false</code>，然后就绕过去了。</p><p>去网页上试了试，发现不接受非数字输入，所以最后 <code>curl</code> 两行流了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>export</span> <span class=nv>TOKEN</span><span class=o>=</span><span class=s1>&#39;&lt;YOUR TOKEN&gt;&#39;</span>
</span></span><span class=line><span class=cl>curl <span class=s1>&#39;http://202.38.93.111:18000/state&#39;</span> -H <span class=s2>&#34;Authorization: Bearer </span><span class=si>${</span><span class=nv>TOKEN</span><span class=si>}</span><span class=s2>&#34;</span> --data-raw <span class=s1>&#39;&lt;state&gt;&lt;guess&gt;NaN&lt;/guess&gt;&lt;/state&gt;&#39;</span>
</span></span><span class=line><span class=cl>curl -H <span class=s2>&#34;Authorization: Bearer </span><span class=si>${</span><span class=nv>TOKEN</span><span class=si>}</span><span class=s2>&#34;</span> <span class=s1>&#39;http://202.38.93.111:18000/state&#39;</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=latex-机器人>LaTeX 机器人</h2><h3 id=纯文本>纯文本</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl><span class=k>\texttt</span><span class=nb>{</span><span class=k>\input</span><span class=nb>{</span>/flag1<span class=nb>}}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=特殊字符混入>特殊字符混入</h3><p>根据文档，<code>\input</code> 的操作跟 C 的 <code>#include</code> 很像，直接把内容从文件 copy 过来然后当文档的一部分编译。搜了很久怎么在 document 里面插入新的 document 然后引入 <code>\verbatiminput</code>，然后发现一个命令 <code>\catcode</code>，可以修改一个字符的 category code，那直接把 <code>#</code> 和 <code>_</code> 都改成字符的类型就可以了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-latex data-lang=latex><span class=line><span class=cl><span class=k>\catcode</span>`<span class=k>\_</span>=11 <span class=k>\catcode</span>`<span class=k>\#</span>=11 <span class=k>\texttt</span><span class=nb>{</span><span class=k>\input</span><span class=nb>{</span>/flag2<span class=nb>}}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=flag-的痕迹>Flag 的痕迹</h2><p>打开 DokuWiki 官网，进任意页面的 revisions 随便玩一下就会发现，带参数 <code>do=diff</code> 就可以打开两个页面的 diff，回来对主页 diff 一下就做完了。</p><h2 id=安全的在线测评>安全的在线测评</h2><h3 id=无法-ac-的题目>无法 AC 的题目</h3><p>看了下判题脚本，<code>static.out</code> 文件并没有特殊的权限设置，猜测可以直接读，随便写个读文件的 C 代码就过了。</p><h3 id=动态数据>动态数据</h3><p>重新审计判题脚本，发现实际的数据生成是脚本里面做的，然后 <code>gcc</code> 也是脚本起的，所以 <code>gcc</code> 有读数据的权限。想办法从编译下手。</p><p>首先第一个想到的是 <code>#include</code>，但是 <code>#include</code> 从工作原理上来说会对文件做操作，而 <code>dynamic.out</code> 都是两行的大数字，不是标准 C 文件，调了半个小时放弃。</p><p>然后胡乱搜索，最终发现了这篇<a href=http://elm-chan.org/junk/32bit/binclude.html target=_blank rel="noopener noreffer">文章</a>，里面提到可以用 <code>.incbin</code> 这个 inline asm 编译期包含文件。</p><p>然后这题就做完了？没有。由于我的汇编水平相比去年长进十分有限（$|\Delta| &lt; \epsilon$），我照着这篇文章和 Stackoverflow 的好多回答抄的代码都 crash 了。然后我搜到了<a href=https://github.com/graphitemaster/incbin target=_blank rel="noopener noreffer">这个项目</a>，发现是 500 行的 header-only，直接 copy 交了，然后 WA 了。重新读了遍代码，发现是没判断输入，一把子全输出了，<del>直接把打 ACM 的经验全部扔了</del>，改改然后 fuzz 一下就过了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-C data-lang=C><span class=line><span class=cl><span class=c1>// 这里应该有上面仓库提到的 .h
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>stt</span><span class=p>,</span> <span class=s>&#34;./data/static.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy0</span><span class=p>,</span> <span class=s>&#34;./data/dynamic0.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy1</span><span class=p>,</span> <span class=s>&#34;./data/dynamic1.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy2</span><span class=p>,</span> <span class=s>&#34;./data/dynamic2.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy3</span><span class=p>,</span> <span class=s>&#34;./data/dynamic3.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy4</span><span class=p>,</span> <span class=s>&#34;./data/dynamic4.out&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>sttIn</span><span class=p>,</span> <span class=s>&#34;./data/static.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy0In</span><span class=p>,</span> <span class=s>&#34;./data/dynamic0.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy1In</span><span class=p>,</span> <span class=s>&#34;./data/dynamic1.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy2In</span><span class=p>,</span> <span class=s>&#34;./data/dynamic2.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy3In</span><span class=p>,</span> <span class=s>&#34;./data/dynamic3.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=nf>INCTXT</span><span class=p>(</span><span class=n>dy4In</span><span class=p>,</span> <span class=s>&#34;./data/dynamic4.in&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>input</span><span class=p>[</span><span class=mi>2000</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=nf>scanf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>l</span> <span class=o>=</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>input</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>input</span><span class=p>[</span><span class=n>l</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\n&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=n>input</span><span class=p>[</span><span class=n>l</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gsttInData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gsttData</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gdy0InData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gdy0Data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gdy1InData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gdy1Data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gdy2InData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gdy2Data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gdy3InData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gdy3Data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=nf>strcmp</span><span class=p>(</span><span class=n>input</span><span class=p>,</span> <span class=n>gdy4InData</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=n>gdy4Data</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=线路板>线路板</h2><p>下载 Kicad，所有文件导入进去，当 Photoshop 玩一下就能看到了。</p><h2 id=flag-自动机>Flag 自动机</h2><p>今年学习了一手渗透测试，然后我终于调好了能下断点的 IDA 了，但是一次都没用过。</p><p>下载了 <code>flag_machine.exe</code> 先玩了一下，大概有个思路打开 IDA 看了下，工作方式比较简单，进来直接搞了个窗口程序就跑了。审计一下窗口初始化的伪代码：</p><a class=lightgallery href=https://assets.lxdlam.com/img/1667026985_47549a4c.png title=https://assets.lxdlam.com/img/1667026985_47549a4c.png data-thumbnail=https://assets.lxdlam.com/img/1667026985_47549a4c.png><img class=lazyload src=/svg/loading.min.svg data-src=https://assets.lxdlam.com/img/1667026985_47549a4c.png data-srcset="https://assets.lxdlam.com/img/1667026985_47549a4c.png, https://assets.lxdlam.com/img/1667026985_47549a4c.png 1.5x, https://assets.lxdlam.com/img/1667026985_47549a4c.png 2x" data-sizes=auto alt=https://assets.lxdlam.com/img/1667026985_47549a4c.png width=100%></a><p>核心的消息收发函数应该是 <code>WndClass.lpfnWndProc</code>，直接审计 <code>sub_401510</code>。</p><a class=lightgallery href=https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png title=https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png data-thumbnail=https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png><img class=lazyload src=/svg/loading.min.svg data-src=https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png data-srcset="https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png, https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png 1.5x, https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png 2x" data-sizes=auto alt=https://assets.lxdlam.com/img/1667027067_1e7b8ad3.png width=100%></a><p>进来看了下这里有个 Congratulations，看了下下面直接把 flag 写到文件了，那么 <code>sub_401F8A</code> 应该就可以直接把 flag 吐出来。进去看下：</p><a class=lightgallery href=https://assets.lxdlam.com/img/1667027105_69bec2d6.png title=https://assets.lxdlam.com/img/1667027105_69bec2d6.png data-thumbnail=https://assets.lxdlam.com/img/1667027105_69bec2d6.png><img class=lazyload src=/svg/loading.min.svg data-src=https://assets.lxdlam.com/img/1667027105_69bec2d6.png data-srcset="https://assets.lxdlam.com/img/1667027105_69bec2d6.png, https://assets.lxdlam.com/img/1667027105_69bec2d6.png 1.5x, https://assets.lxdlam.com/img/1667027105_69bec2d6.png 2x" data-sizes=auto alt=https://assets.lxdlam.com/img/1667027105_69bec2d6.png width=100%></a><p>发现 flag 会先被放到 <code>Destination</code> 里，然后 return 回去，那跑下 <code>401F8A</code> 应该就可以了。</p><p>找到地址，结果刚启动 debugger 就 crash 了。找了各种教程，发现用 windbg 也 crash，一通搜索之后发现好像是 anti-debug 了，跟着教程搞了个 Ollydbg，然后又找到个插件 ScyllaHide，配完了进去跑，啥问题没有。直接把 EIP 改成 <code>0x401f8a</code>，然后执行一下，就能在内存上看到 flag 了。</p><a class=lightgallery href=https://assets.lxdlam.com/img/1667027115_d3f1ec96.png title=https://assets.lxdlam.com/img/1667027115_d3f1ec96.png data-thumbnail=https://assets.lxdlam.com/img/1667027115_d3f1ec96.png><img class=lazyload src=/svg/loading.min.svg data-src=https://assets.lxdlam.com/img/1667027115_d3f1ec96.png data-srcset="https://assets.lxdlam.com/img/1667027115_d3f1ec96.png, https://assets.lxdlam.com/img/1667027115_d3f1ec96.png 1.5x, https://assets.lxdlam.com/img/1667027115_d3f1ec96.png 2x" data-sizes=auto alt=https://assets.lxdlam.com/img/1667027115_d3f1ec96.png width=100%></a><h2 id=微积分计算小练习>微积分计算小练习</h2><p>看了下执行脚本，应该是需要通过 XSS 给 cookie 弄出来。试了下容器里没有网，掉头看第一个页面。</p><p>第一个页面里随便玩了几次，发现输入相同的 input 吐出来的结果是一样的，把 <code>result=</code> 后面的 value 拖进 CyberChef 然后 URL decode 了一下，自动检测出来是 base64 过后的 <code>score:username</code> 数据。</p><a class=lightgallery href=https://assets.lxdlam.com/img/1667027123_af288ea7.png title=https://assets.lxdlam.com/img/1667027123_af288ea7.png data-thumbnail=https://assets.lxdlam.com/img/1667027123_af288ea7.png><img class=lazyload src=/svg/loading.min.svg data-src=https://assets.lxdlam.com/img/1667027123_af288ea7.png data-srcset="https://assets.lxdlam.com/img/1667027123_af288ea7.png, https://assets.lxdlam.com/img/1667027123_af288ea7.png 1.5x, https://assets.lxdlam.com/img/1667027123_af288ea7.png 2x" data-sizes=auto alt=https://assets.lxdlam.com/img/1667027123_af288ea7.png width=100%></a><p>审计了一下前端代码，发现这两个地方直接做的 HTML 拼接，那都有注入点。fuzz 了一下得到一个可行的 payload：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-plain data-lang=plain><span class=line><span class=cl>&lt;a href=&#34;x&#34; onfocus=&#34;document.querySelector(&#39;#greeting&#39;).textContent=document.cookie;&#34; autofocus=&#34;&#34;&gt;xss&lt;/a&gt;:123
</span></span></code></pre></td></tr></table></div></div><p>转成 base64，encoding 完了拼一下链接，交了就过了。</p><h2 id=杯窗鹅影>杯窗鹅影</h2><h3 id=flag1>flag1</h3><p>拉了个镜像，随便写了个读文件的代码，编译完交了就过了……</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>FILE</span> <span class=o>*</span><span class=n>f</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;/flag1&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>c</span> <span class=o>=</span> <span class=nf>fgetc</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>c</span> <span class=o>!=</span> <span class=n>EOF</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=nf>putchar</span><span class=p>(</span><span class=n>c</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=nf>fgetc</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=nf>fclose</span><span class=p>(</span><span class=n>f</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=flag2>flag2</h3><p>Wine 本身并不是搞了个 sandbox 或者 vm 之类的东西，而是相当于当你调用 Win32api 的时候，link 到的库是 Wine 的库，Wine 提供了这些函数在 Linux 下的等价（或者说勉强能用）的实现，然后直接跑，而至于原生 Linux 函数就直接 passthrough 了。</p><p>虽然这些我都知道，但是做的非常磕绊。因为第一问给了我一个错觉，以为直接 syscall 就行了，尝试直接 <code>execve</code>，发现跑不起来，然后尝试了一众 Windows API，比如 <code>CreateProcess</code>, <code>ShellExecute</code> 等等，都找不到资源，然后根据第一问的 flag 尝试去遍历文件夹，还把运行环境给摸透了，但是最后就是跑不起来，一度让我怀疑自己是不是方向走远了。</p><p>最后翻了翻去年自己的题解找灵感，发现好像还可以试试汇编直接 call syscall，又把 x86 syscall 表翻了出来，照着抄了下就过了……</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>asm</span><span class=p>(</span><span class=s>&#34;mov $0x0b, %eax; mov $.LC0, %ebx; mov $0, %ecx; mov $0, %edx; int $0x80; &#34;</span>
</span></span><span class=line><span class=cl>      <span class=s>&#34;.LC0: .string </span><span class=se>\&#34;</span><span class=s>/readflag</span><span class=se>\&#34;</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=蒙特卡罗轮盘赌>蒙特卡罗轮盘赌</h2><p>拉了镜像跑了下，发现后面 <code>clock()</code> 的数值大概在 1000 上下，写了个模拟从 0~2000 各模拟了一遍，然后跟题目交互了一下，一次过。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;time.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>double</span> <span class=nf>rand01</span><span class=p>()</span> <span class=p>{</span> <span class=k>return</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=nf>rand</span><span class=p>()</span> <span class=o>/</span> <span class=n>RAND_MAX</span><span class=p>;</span> <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>void</span> <span class=nf>monte_carlo</span><span class=p>(</span><span class=kt>unsigned</span> <span class=kt>int</span> <span class=n>seed</span><span class=p>,</span> <span class=kt>int</span> <span class=n>count</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=nf>srand</span><span class=p>(</span><span class=n>seed</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%u: &#34;</span><span class=p>,</span> <span class=n>seed</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>count</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>M</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>N</span> <span class=o>=</span> <span class=mi>400000</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>j</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>j</span> <span class=o>&lt;</span> <span class=n>N</span><span class=p>;</span> <span class=n>j</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=kt>double</span> <span class=n>x</span> <span class=o>=</span> <span class=nf>rand01</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=kt>double</span> <span class=n>y</span> <span class=o>=</span> <span class=nf>rand01</span><span class=p>();</span>
</span></span><span class=line><span class=cl>      <span class=k>if</span> <span class=p>(</span><span class=n>x</span> <span class=o>*</span> <span class=n>x</span> <span class=o>+</span> <span class=n>y</span> <span class=o>*</span> <span class=n>y</span> <span class=o>&lt;</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>M</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=kt>double</span> <span class=n>pi</span> <span class=o>=</span> <span class=p>(</span><span class=kt>double</span><span class=p>)</span><span class=n>M</span> <span class=o>/</span> <span class=n>N</span> <span class=o>*</span> <span class=mi>4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%1.5f%c&#34;</span><span class=p>,</span> <span class=n>pi</span><span class=p>,</span> <span class=s>&#34;,</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>[</span><span class=n>i</span> <span class=o>==</span> <span class=n>count</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>(</span><span class=kt>int</span> <span class=n>argc</span><span class=p>,</span> <span class=kt>char</span> <span class=o>**</span><span class=n>argv</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>&lt;</span> <span class=mi>2</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>unsigned</span> <span class=n>tt</span> <span class=o>=</span> <span class=nf>time</span><span class=p>(</span><span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;=</span> <span class=mi>2000</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>monte_carlo</span><span class=p>(</span><span class=n>tt</span> <span class=o>+</span> <span class=n>i</span><span class=p>,</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span> <span class=k>else</span> <span class=k>if</span> <span class=p>(</span><span class=n>argc</span> <span class=o>&gt;=</span> <span class=mi>3</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>timestamp</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=nf>strtol</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>count</span> <span class=o>=</span> <span class=p>(</span><span class=kt>int</span><span class=p>)</span><span class=nf>strtol</span><span class=p>(</span><span class=n>argv</span><span class=p>[</span><span class=mi>2</span><span class=p>],</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>10</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=nf>monte_carlo</span><span class=p>(</span><span class=n>timestamp</span><span class=p>,</span> <span class=n>count</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=惜字如金>惜字如金</h2><h3 id=hs384>HS384</h3><p>给定了惜字如金化的 secret 和 sha384 后的结果，字典很小可以直接枚举然后爆，写个脚本几秒就算出来了。</p><p>本届最谜语人题目，我一开始直接爆了所有可见 ascii 字符，看榜上这么多人过得飞快寻思也不是都有超算啊，然后看了下补充说明，猜测是这样，然后 fuzz 了两个小时过了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hashlib</span> <span class=kn>import</span> <span class=n>sha384</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>hmac</span> <span class=kn>import</span> <span class=n>digest</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>base64</span> <span class=kn>import</span> <span class=n>urlsafe_b64encode</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>os</span> <span class=kn>import</span> <span class=n>getcwd</span><span class=p>,</span> <span class=n>path</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>traverse</span><span class=p>(</span><span class=n>candidate</span><span class=p>,</span> <span class=n>count</span><span class=p>,</span> <span class=n>fixed</span><span class=o>=</span><span class=kc>False</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>candidate</span><span class=p>)</span> <span class=o>==</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>fixed</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=n>candidate</span> <span class=o>*</span> <span class=n>count</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>count</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>yield</span> <span class=n>candidate</span> <span class=o>*</span> <span class=p>(</span><span class=n>count</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;e&#39;</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>count</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>yield</span> <span class=n>candidate</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>i</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=k>yield</span> <span class=n>candidate</span> <span class=o>*</span> <span class=p>(</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>)</span> <span class=o>+</span> <span class=s1>&#39;e&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>sz</span> <span class=o>=</span> <span class=n>count</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>candidate</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>can</span><span class=p>,</span> <span class=n>nxt</span> <span class=o>=</span> <span class=n>candidate</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=n>candidate</span><span class=p>[</span><span class=mi>1</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=n>sz</span> <span class=o>+</span> <span class=mi>1</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=n>lhs</span> <span class=o>=</span> <span class=n>can</span> <span class=o>*</span> <span class=n>i</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>rhs</span> <span class=ow>in</span> <span class=n>traverse</span><span class=p>(</span><span class=n>nxt</span><span class=p>,</span> <span class=n>count</span> <span class=o>-</span> <span class=n>i</span><span class=p>,</span> <span class=n>fixed</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>yield</span> <span class=n>lhs</span> <span class=o>+</span> <span class=n>rhs</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>xzrj</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;.&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=nb>map</span><span class=p>(</span><span class=n>xzrj_part</span><span class=p>,</span> <span class=n>s</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;.&#39;</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>xzrj_part</span><span class=p>(</span><span class=n>s</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=p>[</span><span class=n>s</span><span class=p>[</span><span class=mi>0</span><span class=p>]]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=ow>in</span> <span class=s1>&#39;aeiou.0123456789&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>        <span class=k>elif</span> <span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>]</span> <span class=o>!=</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>s</span><span class=p>[</span><span class=n>i</span><span class=p>])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>)</span> <span class=o>&gt;</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;e&#39;</span> <span class=ow>and</span> <span class=n>ret</span><span class=p>[</span><span class=o>-</span><span class=mi>2</span><span class=p>]</span> <span class=ow>not</span> <span class=ow>in</span> <span class=s1>&#39;aeiou.0123456789&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span> <span class=o>=</span> <span class=n>ret</span><span class=p>[:</span><span class=o>-</span><span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>ret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ustc.edu.cn</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>get_key</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>first</span> <span class=ow>in</span> <span class=n>traverse</span><span class=p>(</span><span class=s1>&#39;stc&#39;</span><span class=p>,</span> <span class=mi>31</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>second</span> <span class=ow>in</span> <span class=n>traverse</span><span class=p>(</span><span class=s1>&#39;d&#39;</span><span class=p>,</span> <span class=mi>32</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>first</span><span class=p>)):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>third</span> <span class=ow>in</span> <span class=n>traverse</span><span class=p>(</span><span class=s1>&#39;cn&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                                  <span class=mi>34</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>first</span><span class=p>)</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>second</span><span class=p>),</span>
</span></span><span class=line><span class=cl>                                  <span class=n>fixed</span><span class=o>=</span><span class=kc>True</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=n>key</span> <span class=o>=</span> <span class=s1>&#39;u&#39;</span> <span class=o>+</span> <span class=s1>&#39;.&#39;</span><span class=o>.</span><span class=n>join</span><span class=p>([</span><span class=n>first</span><span class=p>,</span> <span class=sa>f</span><span class=s1>&#39;e</span><span class=si>{</span><span class=n>second</span><span class=si>}</span><span class=s1>u&#39;</span><span class=p>,</span> <span class=n>third</span><span class=p>])</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=n>xzrj</span><span class=p>(</span><span class=n>key</span><span class=p>)</span> <span class=o>==</span> <span class=s1>&#39;ustc.edu.cn&#39;</span> <span class=ow>and</span> <span class=s1>&#39;62074271866&#39;</span> <span class=ow>in</span> <span class=n>sha384</span><span class=p>(</span>
</span></span><span class=line><span class=cl>                        <span class=n>key</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>():</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=n>key</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>key</span> <span class=o>=</span> <span class=n>get_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;key=</span><span class=si>{</span><span class=n>key</span><span class=si>}</span><span class=s1>, sha348(key)=</span><span class=si>{</span><span class=n>sha384</span><span class=p>(</span><span class=n>key</span><span class=o>.</span><span class=n>encode</span><span class=p>())</span><span class=o>.</span><span class=n>hexdigest</span><span class=p>()</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>_</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>3</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>file</span> <span class=o>=</span> <span class=nb>input</span><span class=p>(</span><span class=s1>&#39;input a path: &#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=n>path</span><span class=o>.</span><span class=n>join</span><span class=p>(</span><span class=n>getcwd</span><span class=p>(),</span> <span class=n>file</span><span class=p>),</span> <span class=s1>&#39;rb&#39;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;digest: &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                  <span class=n>urlsafe_b64encode</span><span class=p>(</span><span class=n>digest</span><span class=p>(</span><span class=n>key</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span> <span class=n>f</span><span class=o>.</span><span class=n>read</span><span class=p>(),</span> <span class=n>sha384</span><span class=p>)))</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=置换魔群>置换魔群</h2><h3 id=置换群上的-rsa>置换群上的 RSA</h3><p>给定对称群 $S_n$，随机选一个元素 $s\in S_n$，然后给定 $n$ 和 $s^e, e=65537$，求 $s$。</p><p>首先是对称群的一些非常好用的性质：</p><ul><li>考虑对称群上元素的两行置换写法，其实两行交换一下就是逆元，开销非常小。</li><li>元素的阶 $\sigma(s)$，也就是 $(\mathbb{Z}/{n}\mathbb{Z})^\times$ 上的 $\phi(n)$，实际上将群写成轮换形式，就是对轮换长度求一下最小公倍数，同时还有 $s^{\sigma(s)}=\text{id}$。</li><li>群上的乘法其实就是对元素做交换，虽然有左右乘的关系，但是本题都是 $s$ 的倍数，所以可以直接搞。</li></ul><p>然后其实是解一个很简单的问题。由于 $e$ 一定跟元素的阶 $\sigma(s^e)$ 互质，而这个群的阶又至少能整除 $s$ 的阶，我们可以尝试构造式子：</p><p>$$
(s^e)^p\times s^{q\sigma(s^e)}=s, \text{where}\ p, q\in\mathbb{Z}
$$</p><p>注意到 $s^{q\sigma(s)}=s^{q\sigma(s^e)}=\text{id}$，提一下 $s$ 的幂次，我们有</p><p>$$
pe+q\sigma(s^e)=1
$$</p><p>然后就是一个经典问题了，直接 exgcd。注意到后面 $(s^e)^{q\sigma(s^e)}$ 到最后其实是 $\text{id}$，可以直接无视掉，直接求 $(s^e)^p$ 就解决问题了。如果 $p$ 是负数那就对逆元求幂。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>remote</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy</span> <span class=kn>import</span> <span class=n>gcdex</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>task1</span><span class=p>(</span><span class=n>remote</span><span class=p>:</span> <span class=n>remote</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Start task 1.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>remote</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;Hi, welcome to permutation world. Choose one challenge to solve.</span><span class=se>\n</span><span class=s1>&gt; 1. RSA in permutation group.</span><span class=se>\n</span><span class=s1>&gt; 2. DHKE in permutation group.</span><span class=se>\n</span><span class=s1>&gt; 3. DHKE++ in permutation group.</span><span class=se>\n</span><span class=s1>&gt; other: exit()</span><span class=se>\n\n</span><span class=s1>&gt; your choice: &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;1&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>remote</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;Since the order of the permutation group can be computed easily, the RSA cryptography is not safe in this gruop.</span><span class=se>\n</span><span class=s1>Anyway, I decide to give this flag to you for free. Just get it!</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>15</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>line</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>][</span><span class=mi>24</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: n = </span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>remote</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span><span class=sa>b</span><span class=s1>&#39;[+] my encrypted secret is here: </span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>secret</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>rstrip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: secret[:10] = </span><span class=si>{</span><span class=n>secret</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=c1>## CORE</span>
</span></span><span class=line><span class=cl>        <span class=n>Sn</span> <span class=o>=</span> <span class=n>SymmetricGroup</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>secret</span> <span class=o>=</span> <span class=n>Sn</span><span class=p>(</span><span class=n>secret</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>a</span> <span class=o>=</span> <span class=n>gcdex</span><span class=p>(</span><span class=mi>65537</span><span class=p>,</span> <span class=n>secret</span><span class=o>.</span><span class=n>order</span><span class=p>())[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>=</span> <span class=n>bp</span><span class=p>(</span><span class=n>Sn</span><span class=o>.</span><span class=n>identity</span><span class=p>(),</span> <span class=n>secret</span> <span class=k>if</span> <span class=n>a</span> <span class=o>&gt;</span> <span class=mi>0</span> <span class=k>else</span> <span class=n>secret</span><span class=o>.</span><span class=n>inverse</span><span class=p>(),</span> <span class=nb>abs</span><span class=p>(</span><span class=n>a</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: ans[:10] = </span><span class=si>{</span><span class=n>ans</span><span class=o>.</span><span class=n>domain</span><span class=p>()[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>remote</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s1>&#39;[+] Prove that you own the secret (a list like [1,2,3]): </span><span class=se>\n</span><span class=s1>&gt; your answer: &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>ans</span><span class=o>.</span><span class=n>domain</span><span class=p>())</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>line</span> <span class=o>!=</span> <span class=sa>b</span><span class=s1>&#39;Good job</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[!] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: Failed! line = </span><span class=si>{</span><span class=n>line</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] All done!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Remain bytes: </span><span class=si>{</span><span class=n>remote</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h3 id=置换群上的-dh>置换群上的 DH</h3><p>其实我感觉要比上一问简单，由于置换群的阶是轮换的最小公倍数，这个数一定是光滑的，那么跑什么直接求离散对数的算法都会很快。拿 sage 随便构造一下，直接跑 <code>discrete_log</code> 就出来了。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>pwn</span> <span class=kn>import</span> <span class=n>remote</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sympy</span> <span class=kn>import</span> <span class=n>gcdex</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>sage.all</span> <span class=kn>import</span> <span class=o>*</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>task2</span><span class=p>(</span><span class=n>remote</span><span class=p>:</span> <span class=n>remote</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;[+] Start task 2.&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>remote</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;Hi, welcome to permutation world. Choose one challenge to solve.</span><span class=se>\n</span><span class=s1>&gt; 1. RSA in permutation group.</span><span class=se>\n</span><span class=s1>&gt; 2. DHKE in permutation group.</span><span class=se>\n</span><span class=s1>&gt; 3. DHKE++ in permutation group.</span><span class=se>\n</span><span class=s1>&gt; other: exit()</span><span class=se>\n\n</span><span class=s1>&gt; your choice: &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s1>&#39;2&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>remote</span><span class=o>.</span><span class=n>recvuntil</span><span class=p>(</span>
</span></span><span class=line><span class=cl>        <span class=sa>b</span><span class=s2>&#34;Since permutation group&#39;s order is super large, I believe the discrete logarithm problem is hard to solve in this group.</span><span class=se>\n</span><span class=s2>Therefore I plan to implement the DH protocol in this magic group.</span><span class=se>\n</span><span class=s2>Now, go and crack my private key!</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>        <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>15</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()</span><span class=o>.</span><span class=n>split</span><span class=p>(</span><span class=s1>&#39;,&#39;</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>n</span> <span class=o>=</span> <span class=nb>int</span><span class=p>(</span><span class=n>line</span><span class=p>[</span><span class=mi>0</span><span class=p>][</span><span class=mi>23</span><span class=p>:])</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>line</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=mi>5</span><span class=p>:]</span><span class=o>.</span><span class=n>rstrip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: n = </span><span class=si>{</span><span class=n>n</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: g[:10] = </span><span class=si>{</span><span class=n>g</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>y</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span><span class=o>.</span><span class=n>decode</span><span class=p>()[</span><span class=mi>20</span><span class=p>:]</span><span class=o>.</span><span class=n>rstrip</span><span class=p>())</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: y[:10] = </span><span class=si>{</span><span class=n>y</span><span class=p>[:</span><span class=mi>10</span><span class=p>]</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>Sn</span> <span class=o>=</span> <span class=n>SymmetricGroup</span><span class=p>(</span><span class=n>n</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>g</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>Sn</span><span class=p>(</span><span class=n>g</span><span class=p>),</span> <span class=n>Sn</span><span class=p>(</span><span class=n>y</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>ans</span> <span class=o>=</span> <span class=n>discrete_log</span><span class=p>(</span><span class=n>y</span><span class=p>,</span> <span class=n>g</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[+] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: ans = </span><span class=si>{</span><span class=n>ans</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>remote</span><span class=o>.</span><span class=n>sendlineafter</span><span class=p>(</span>
</span></span><span class=line><span class=cl>            <span class=sa>b</span><span class=s1>&#39;[+] Prove that you own the secret: </span><span class=se>\n</span><span class=s1>&gt; your answer: &#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=nb>str</span><span class=p>(</span><span class=n>ans</span><span class=p>)</span><span class=o>.</span><span class=n>encode</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>            <span class=n>timeout</span><span class=o>=</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>line</span> <span class=o>=</span> <span class=n>remote</span><span class=o>.</span><span class=n>recvline</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>line</span> <span class=o>!=</span> <span class=sa>b</span><span class=s1>&#39;Good job</span><span class=se>\n</span><span class=s1>&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;[!] Round </span><span class=si>{</span><span class=n>i</span><span class=o>+</span><span class=mi>1</span><span class=si>}</span><span class=s2>: Failed! line = </span><span class=si>{</span><span class=n>line</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] All done!&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;[+] Remain bytes: </span><span class=si>{</span><span class=n>remote</span><span class=o>.</span><span class=n>recv</span><span class=p>()</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=光与影>光与影</h2><p>虽然我不懂 WebGL，但是本科图形学课上还是学了一点渲染，用 Chrome 的本地文件替换随便玩了下，发现把 302 行的 <code>float t5 = t5SDF(p - vec3(36.0, 10.0, 15.0), vec3(30.0, 5.0, 5.0), 2.0);</code> fuzz 一下那块噪音就会跑，随便搞搞就出来了。</p><h2 id=链上记忆大师>链上记忆大师</h2><h3 id=记忆练习>记忆练习</h3><p>20 分钟做完，18 分钟看文档。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-sol data-lang=sol><span class=line><span class=cl><span class=k>pragma solidity</span> <span class=o>=</span><span class=mi>0</span><span class=p>.</span><span class=mi>8</span><span class=p>.</span><span class=mi>17</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kd>contract</span> <span class=nc>Storage</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>uint256</span> <span class=n>val</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>memorize</span><span class=p>(</span><span class=kt>uint256</span> <span class=n>n</span><span class=p>)</span> <span class=k>external</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>val</span> <span class=o>=</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kd>function</span> <span class=nf>recall</span><span class=p>()</span> <span class=k>external</span> <span class=k>view</span> <span class=k>returns</span> <span class=p>(</span><span class=kt>uint256</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>val</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=片上系统>片上系统</h2><h3 id=引导扇区>引导扇区</h3><p>下一个 PulseView，用 SPI Decoder 连对线，注意到最密密麻麻的应该是 Clock，解出来第一个 block 数据拷出来就有 flag 了。</p><h2 id=看不见的彼方>看不见的彼方</h2><p>审计代码：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>socket</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>accept</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>bind</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>connect</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>listen</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>recv</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>recvfrom</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>recvmsg</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>send</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>sendmsg</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>sendto</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>setsockopt</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>shutdown</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>socketcall</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>socketpair</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>getsockname</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>getpeername</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>getsockopt</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>accept4</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>recvmmsg</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>sendmmsg</span><span class=p>));</span>
</span></span><span class=line><span class=cl><span class=nf>add_rule</span><span class=p>(</span><span class=o>&amp;</span><span class=n>ctx</span><span class=p>,</span> <span class=nf>SCMP_SYS</span><span class=p>(</span><span class=n>ptrace</span><span class=p>));</span>
</span></span></code></pre></td></tr></table></div></div><p>把基于 socket 做 ipc 的 api 都 ban 了，但是除了 socket Linux 还有<del>十万种甚至九万种</del>很多种 ipc 方法，写了个基于 shm 的解决了。</p><p>Alice:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/ipc.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/shm.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define KEY_ID 1919810
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>shm_id</span> <span class=o>=</span> <span class=nf>shmget</span><span class=p>(</span><span class=n>KEY_ID</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=n>IPC_CREAT</span> <span class=o>|</span> <span class=mo>0666</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=n>FILE</span><span class=o>*</span> <span class=n>reader</span> <span class=o>=</span> <span class=nf>fopen</span><span class=p>(</span><span class=s>&#34;/secret&#34;</span><span class=p>,</span> <span class=s>&#34;r&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=kt>char</span> <span class=n>flag</span><span class=p>[</span><span class=mi>2000</span><span class=p>];</span>
</span></span><span class=line><span class=cl>  <span class=nf>fgets</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span> <span class=mi>2000</span><span class=p>,</span> <span class=n>reader</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>fclose</span><span class=p>(</span><span class=n>reader</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=kt>void</span><span class=o>*</span> <span class=n>shm</span> <span class=o>=</span> <span class=nf>shmat</span><span class=p>(</span><span class=n>shm_id</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>memcpy</span><span class=p>(</span><span class=n>shm</span><span class=p>,</span> <span class=n>flag</span><span class=p>,</span> <span class=nf>strlen</span><span class=p>(</span><span class=n>flag</span><span class=p>)</span> <span class=o>+</span> <span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=nf>shmdt</span><span class=p>(</span><span class=n>shm</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><p>Bob:</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdio.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;stdlib.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;string.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/ipc.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/shm.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;sys/types.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp>#include</span> <span class=cpf>&lt;unistd.h&gt;</span><span class=cp>
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=cp>#define KEY_ID 1919810
</span></span></span><span class=line><span class=cl><span class=cp></span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// sleep 5 seconds to wait read end
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nf>sleep</span><span class=p>(</span><span class=mi>5</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=k>for</span> <span class=p>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=mi>1000</span><span class=p>;</span> <span class=n>i</span><span class=o>++</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>shm_id</span> <span class=o>=</span> <span class=nf>shmget</span><span class=p>(</span><span class=n>KEY_ID</span><span class=p>,</span> <span class=mi>128</span><span class=p>,</span> <span class=n>IPC_CREAT</span> <span class=o>|</span> <span class=mo>0666</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>shm_id</span> <span class=o>==</span> <span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;get shm_id failed.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>void</span><span class=o>*</span> <span class=n>shm</span> <span class=o>=</span> <span class=nf>shmat</span><span class=p>(</span><span class=n>shm_id</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>,</span> <span class=mi>0</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>shm</span> <span class=o>==</span> <span class=p>(</span><span class=kt>void</span><span class=o>*</span><span class=p>)</span><span class=o>-</span><span class=mi>1</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>      <span class=nf>fprintf</span><span class=p>(</span><span class=n>stderr</span><span class=p>,</span> <span class=s>&#34;get shm failed.</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl>      <span class=k>continue</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=kt>char</span> <span class=n>flag</span><span class=p>[</span><span class=mi>2000</span><span class=p>];</span>
</span></span><span class=line><span class=cl>    <span class=nf>memcpy</span><span class=p>(</span><span class=n>flag</span><span class=p>,</span> <span class=n>shm</span><span class=p>,</span> <span class=mi>64</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>flag</span><span class=p>[</span><span class=mi>64</span><span class=p>]</span> <span class=o>=</span> <span class=sc>&#39;\0&#39;</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>printf</span><span class=p>(</span><span class=s>&#34;%s</span><span class=se>\n</span><span class=s>&#34;</span><span class=p>,</span> <span class=n>flag</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=量子藏宝图>量子藏宝图</h2><ul><li>第一幕：看懂 BB84：<a href=https://jia.je/others/2020/05/01/bb84-explained/ target=_blank rel="noopener noreffer">https://jia.je/others/2020/05/01/bb84-explained/</a>。</li><li>第二幕：看懂题目给的提示和 <a href=https://qiskit.org/textbook/ch-algorithms/bernstein-vazirani.html target=_blank rel="noopener noreffer">https://qiskit.org/textbook/ch-algorithms/bernstein-vazirani.html</a>，然后抄图。</li></ul><h2 id=企鹅拼盘>企鹅拼盘</h2><h3 id=这么简单我闭眼都可以>这么简单我闭眼都可以</h3><p>随便 fuzz 一下出答案。</p><h3 id=大力当然出奇迹啦>大力当然出奇迹啦~</h3><p>拼盘游戏每一次移动都可以看作一次 $S_{16}$ 群上的一个置换，而第二轮的移动 bit 非常少（$2^{16}$），预处理一下移动然后直接枚举移动做一下群乘法就行。</p><p>置换群实现我从上面置换魔群抄的。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>from</span> <span class=nn>functools</span> <span class=kn>import</span> <span class=n>reduce</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>permutation_group</span> <span class=kn>import</span> <span class=n>permutation_group</span><span class=p>,</span> <span class=n>permutation_element</span>
</span></span><span class=line><span class=cl><span class=kn>from</span> <span class=nn>json</span> <span class=kn>import</span> <span class=n>loads</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>class</span> <span class=nc>Board</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__init__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=bp>self</span><span class=o>.</span><span class=n>b</span> <span class=o>=</span> <span class=p>[[</span><span class=n>i</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span> <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>)]</span> <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>)]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>_blkpos</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>==</span> <span class=mi>16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>j</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>reset</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=nf>move</span><span class=p>(</span><span class=bp>self</span><span class=p>,</span> <span class=n>moves</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>m</span> <span class=ow>in</span> <span class=n>moves</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>i</span><span class=p>,</span> <span class=n>j</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>_blkpos</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=k>if</span> <span class=n>m</span> <span class=o>==</span> <span class=s1>&#39;L&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>-</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>m</span> <span class=o>==</span> <span class=s1>&#39;R&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>            <span class=k>elif</span> <span class=n>m</span> <span class=o>==</span> <span class=s1>&#39;U&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span> <span class=o>-</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>            <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span>
</span></span><span class=line><span class=cl>                <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span> <span class=o>+</span> <span class=mi>1</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>=</span> <span class=mi>16</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>def</span> <span class=fm>__bool__</span><span class=p>(</span><span class=bp>self</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>            <span class=k>for</span> <span class=n>j</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>4</span><span class=p>):</span>
</span></span><span class=line><span class=cl>                <span class=k>if</span> <span class=bp>self</span><span class=o>.</span><span class=n>b</span><span class=p>[</span><span class=n>i</span><span class=p>][</span><span class=n>j</span><span class=p>]</span> <span class=o>!=</span> <span class=n>i</span> <span class=o>*</span> <span class=mi>4</span> <span class=o>+</span> <span class=n>j</span> <span class=o>+</span> <span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>                    <span class=k>return</span> <span class=kc>True</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=kc>False</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>simulate</span><span class=p>(</span><span class=n>step</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span> <span class=o>=</span> <span class=n>Board</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>b</span><span class=o>.</span><span class=n>move</span><span class=p>(</span><span class=n>step</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>permutation_element</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=n>reduce</span><span class=p>(</span><span class=k>lambda</span> <span class=n>acc</span><span class=p>,</span> <span class=n>x</span><span class=p>:</span> <span class=n>acc</span> <span class=o>+</span> <span class=n>x</span><span class=p>,</span> <span class=n>b</span><span class=o>.</span><span class=n>b</span><span class=p>,</span> <span class=p>[]))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>padding_bin</span><span class=p>(</span><span class=n>num</span><span class=p>,</span> <span class=n>sz</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>s</span> <span class=o>=</span> <span class=nb>bin</span><span class=p>(</span><span class=n>num</span><span class=p>)[</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=s1>&#39;0&#39;</span> <span class=o>*</span> <span class=p>(</span><span class=n>sz</span> <span class=o>-</span> <span class=nb>len</span><span class=p>(</span><span class=n>s</span><span class=p>))</span> <span class=o>+</span> <span class=n>s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>S16</span> <span class=o>=</span> <span class=n>permutation_group</span><span class=p>(</span><span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>with</span> <span class=nb>open</span><span class=p>(</span><span class=s2>&#34;./chal/b16_obf.json&#34;</span><span class=p>,</span> <span class=s2>&#34;r&#34;</span><span class=p>)</span> <span class=k>as</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>line</span> <span class=ow>in</span> <span class=n>f</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>b16</span> <span class=o>=</span> <span class=n>loads</span><span class=p>(</span><span class=n>line</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>final_moves</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>idx</span><span class=p>,</span> <span class=n>moves1</span><span class=p>,</span> <span class=n>moves2</span> <span class=ow>in</span> <span class=n>b16</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>final_moves</span><span class=o>.</span><span class=n>append</span><span class=p>([</span><span class=n>idx</span><span class=p>,</span> <span class=n>simulate</span><span class=p>(</span><span class=n>moves1</span><span class=p>),</span> <span class=n>simulate</span><span class=p>(</span><span class=n>moves2</span><span class=p>)])</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>for</span> <span class=n>i</span> <span class=ow>in</span> <span class=nb>range</span><span class=p>(</span><span class=mi>2</span><span class=o>**</span><span class=mi>16</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=n>b</span> <span class=o>=</span> <span class=n>S16</span><span class=o>.</span><span class=n>identity</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>bits</span> <span class=o>=</span> <span class=n>padding_bin</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=mi>16</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>for</span> <span class=n>bit</span><span class=p>,</span> <span class=n>move1</span><span class=p>,</span> <span class=n>move2</span> <span class=ow>in</span> <span class=n>final_moves</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>b</span> <span class=o>=</span> <span class=n>b</span> <span class=o>*</span> <span class=p>(</span><span class=n>move1</span> <span class=k>if</span> <span class=n>bits</span><span class=p>[</span><span class=n>bit</span><span class=p>]</span> <span class=o>==</span> <span class=s1>&#39;1&#39;</span> <span class=k>else</span> <span class=n>move2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>b</span> <span class=o>!=</span> <span class=n>S16</span><span class=o>.</span><span class=n>identity</span><span class=p>():</span>
</span></span><span class=line><span class=cl>            <span class=nb>print</span><span class=p>(</span><span class=n>i</span><span class=p>,</span> <span class=n>bits</span><span class=p>,</span> <span class=n>b</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=k>break</span>
</span></span></code></pre></td></tr></table></div></div><h2 id=火眼金睛的小-e>火眼金睛的小 E</h2><h3 id=有手就行>有手就行</h3><p>IDA + BinDiff。但是成功率太低了，做了大概七八次才过。</p><p><del>建议本题改名好运来。</del></p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2023-01-04</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://blog.lxdlam.com/post/6918ebb9/ data-title="Hackergame 2022 题解" data-hashtags=Hackergame,Web,逆向,数学,CTF><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://blog.lxdlam.com/post/6918ebb9/ data-hashtag=Hackergame><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Instapaper" data-sharer=instapaper data-url=https://blog.lxdlam.com/post/6918ebb9/ data-title="Hackergame 2022 题解" data-description><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/instapaper.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://blog.lxdlam.com/post/6918ebb9/><i class="fab fa-get-pocket fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://blog.lxdlam.com/post/6918ebb9/ data-title="Hackergame 2022 题解"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://blog.lxdlam.com/post/6918ebb9/ data-title="Hackergame 2022 题解"><i class="fab fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/hackergame/>Hackergame</a>,&nbsp;<a href=/tags/web/>Web</a>,&nbsp;<a href=/tags/%E9%80%86%E5%90%91/>逆向</a>,&nbsp;<a href=/tags/%E6%95%B0%E5%AD%A6/>数学</a>,&nbsp;<a href=/tags/ctf/>CTF</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/post/24e3aa77/ class=prev rel=prev title="任天堂 NPLN 服务架构演讲学习笔记"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>任天堂 NPLN 服务架构演讲学习笔记</a>
<a href=/post/8a92c50b/ class=next rel=next title="PKU GeekGame 2022 题解">PKU GeekGame 2022 题解<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.109.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.lxdlam.com target=_blank>Ramen</a></span>&nbsp;|&nbsp;<span class=license><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>署名-非商业性使用-相同方式共享 4.0 国际</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-92306989-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-92306989-1" async></script></body></html>