<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="noodp"><title>From gcd to RSA - Ramen's Box</title><meta name=Description content="Ramen's stuff box"><meta property="og:title" content="From gcd to RSA"><meta property="og:description" content="这篇文章是有个朋友要选一门数学素养课，涉及到的内容其实并不复杂，就心血来潮的写了这篇文章梳理一下从小学数学到理解 RSA 需要的基础知识。阅读这篇你只需要有基础的阅读能力即可。
这篇文章只是一篇简单的 Walkthrough，如果对其中的某个定理想有更深入的研究，请复制到搜索引擎，网上会有更详细和严谨的资料。同时感谢龙二的审稿。"><meta property="og:type" content="article"><meta property="og:url" content="https://blog.lxdlam.com/post/42be77f6/"><meta property="og:image" content="https://blog.lxdlam.com/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2020-04-14T14:27:53+08:00"><meta property="article:modified_time" content="2022-10-11T03:20:18+08:00"><meta property="og:site_name" content="My cool site"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.lxdlam.com/logo.png"><meta name=twitter:title content="From gcd to RSA"><meta name=twitter:description content="这篇文章是有个朋友要选一门数学素养课，涉及到的内容其实并不复杂，就心血来潮的写了这篇文章梳理一下从小学数学到理解 RSA 需要的基础知识。阅读这篇你只需要有基础的阅读能力即可。
这篇文章只是一篇简单的 Walkthrough，如果对其中的某个定理想有更深入的研究，请复制到搜索引擎，网上会有更详细和严谨的资料。同时感谢龙二的审稿。"><meta name=application-name content="Ramen's Box"><meta name=apple-mobile-web-app-title content="Ramen's Box"><meta name=theme-color content="#ffffff"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://blog.lxdlam.com/post/42be77f6/><link rel=prev href=https://blog.lxdlam.com/post/a31ff541/><link rel=next href=https://blog.lxdlam.com/post/1b1fad8c/><link rel=stylesheet href=/css/style.min.css><link rel=preload href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css></noscript><link rel=preload href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css as=style onload='this.onload=null,this.rel="stylesheet"'><noscript><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css></noscript><meta name=google-site-verification content="UA-92306989-1"><meta name=baidu-site-verification content="092774cb717e6851abd2d7fc55835b40"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"From gcd to RSA","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/blog.lxdlam.com\/post\/42be77f6\/"},"image":["https:\/\/blog.lxdlam.com\/images\/Apple-Devices-Preview.png"],"genre":"posts","keywords":"数学, 学习笔记","wordcount":4694,"url":"https:\/\/blog.lxdlam.com\/post\/42be77f6\/","datePublished":"2020-04-14T14:27:53+08:00","dateModified":"2022-10-11T03:20:18+08:00","license":"本站所有内容基于署名-非商业性使用-相同方式共享 4.0 国际协议（CC BY-NC-SA 4.0）给出许可","publisher":{"@type":"Organization","name":"Ramen","logo":"https:\/\/blog.lxdlam.com\/images\/avatar.png"},"author":{"@type":"Person","name":"Ramen"},"description":""}</script></head><body data-header-desktop=fixed data-header-mobile=auto><script type=text/javascript>(window.localStorage&&localStorage.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("theme","dark")</script><div id=mask></div><div class=wrapper><header class=desktop id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Ramen's Box"><span class=header-title-pre><i class='fas fa-star'></i></span>Ramen's Box</a></div><div class=menu><div class=menu-inner><a class=menu-item href=/posts/>所有文章 </a><a class=menu-item href=/tags/>标签 </a><a class=menu-item href=/categories/>分类 </a><a class=menu-item href=/about/>关于 </a><span class="menu-item delimiter"></span><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></div></header><header class=mobile id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Ramen's Box"><span class=header-title-pre><i class='fas fa-star'></i></span>Ramen's Box</a></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><div class=menu id=menu-mobile><a class=menu-item href=/posts/ title>所有文章</a><a class=menu-item href=/tags/ title>标签</a><a class=menu-item href=/categories/ title>分类</a><a class=menu-item href=/about/ title>关于</a><a href=javascript:void(0); class="menu-item theme-switch" title=切换主题>
<i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></div></header><main class=main><div class=container><div class=toc id=toc-auto><h2 class=toc-title>目录</h2><div class=toc-content id=toc-content-auto></div></div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">From gcd to RSA</h1><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://blog.lxdlam.com title=Author target=_blank rel="noopener noreffer author" class=author><i class="fas fa-user-circle fa-fw" aria-hidden=true></i>Ramen</a></span>&nbsp;<span class=post-category>收录于 <a href=/categories/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/><i class="far fa-folder fa-fw" aria-hidden=true></i>学习笔记</a></span></div><div class=post-meta-line><i class="far fa-calendar-alt fa-fw" aria-hidden=true></i>&nbsp;<time datetime=2020-04-14>2020-04-14</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden=true></i>&nbsp;约 4694 字&nbsp;
<i class="far fa-clock fa-fw" aria-hidden=true></i>&nbsp;预计阅读 10 分钟&nbsp;</div></div><div class="details toc" id=toc-static data-kept><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fas fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#数学运算>数学运算</a><ul><li><a href=#基本运算>基本运算</a></li><li><a href=#取余与同余运算>取余与同余运算</a></li></ul></li><li><a href=#最大公约数>最大公约数</a><ul><li><a href=#约数与-gcd-运算>约数与 gcd 运算</a></li><li><a href=#辗转相除法>辗转相除法</a></li><li><a href=#裴蜀定理>裴蜀定理</a></li><li><a href=#质数与互质>质数与互质</a></li><li><a href=#同余除法第一原理>同余除法第一原理</a></li></ul></li><li><a href=#代数系统群环>代数系统、群、环</a><ul><li><a href=#代数系统>代数系统</a></li><li><a href=#半群和幺半群>半群和幺半群</a></li><li><a href=#群和阿贝尔群>群和阿贝尔群</a></li><li><a href=#环>环</a></li><li><a href=#整数模-n-乘法群>整数模 $n$ 乘法群</a></li></ul></li><li><a href=#欧拉函数和欧拉定理>欧拉函数和欧拉定理</a><ul><li><a href=#欧拉函数>欧拉函数</a></li><li><a href=#欧拉定理>欧拉定理</a></li></ul></li><li><a href=#rsa>RSA</a><ul><li><a href=#rsa-简介>RSA 简介</a></li><li><a href=#rsa-算法>RSA 算法</a></li><li><a href=#安全性>安全性</a></li></ul></li><li><a href=#还有什么>还有什么</a></li></ul></nav></div></div><div class=content id=content><p>这篇文章是有个朋友要选一门数学素养课，涉及到的内容其实并不复杂，就心血来潮的写了这篇文章梳理一下从小学数学到理解 RSA 需要的基础知识。阅读这篇你只需要有基础的阅读能力即可。</p><p>这篇文章只是一篇简单的 Walkthrough，如果对其中的某个定理想有更深入的研究，请复制到搜索引擎，网上会有更详细和严谨的资料。同时感谢龙二的审稿。</p><h2 id=数学运算>数学运算</h2><h3 id=基本运算>基本运算</h3><p>为了方便叙述，我们定义基本运算为下面三种：</p><ul><li>加法运算 $+$；</li><li>减法运算 $-$；</li><li>乘法运算 $\times$ 或者 $\cdot$。</li></ul><p>上述三种运算均满足交换律（$a+b=b+a$）和结合律（$(a+b)+c=a+(b+c)$）。乘法运算对于加减法满足分配律，即 $(a\pm b)\times c = a\times c\pm b\times c$。</p><h3 id=取余与同余运算>取余与同余运算</h3><p><strong>取余运算</strong>：令 $a=kb+r$，其中 $k$ 最大，则 $a$ 模 $b$ 的余数为 $r$，记作 $a{\ \text{mod}\ } b = r$。</p><p><strong>同余运算</strong>：如果 $a{\ \text{mod}\ } r=b{\ \text{mod}\ } r$，则称 $a$ 和 $b$ 模 $r$ 同余，记作 ${{a}\equiv {b}\pmod {r}}$。</p><p><strong>整除运算</strong>：如果 $a{\ \text{mod}\ } b=0$，则称 $b$ 整除 $a$，记作 $b|a$。</p><p>模 $n$ 同余的所有数构成的等价类叫做<strong>同余类</strong>。假定余数为 $a$，则同余类可记作 $[a]=\{\cdots,a-2n,a-n,a,a+n,a+2n,\cdots\}$。如 $3$ 的同余类有 $[0], [1], [2]$ 三个。</p><p>取余和同余保持基本运算（将 $a{\ \text{mod}\ } b = r$ 看作 ${{a}\equiv {r}\pmod {b}}$)，也就是说：</p><p>$$
\left.
\begin{matrix}
{{a}\equiv {b}\pmod {m}}
\\{{c}\equiv {d}\pmod {m}}
\end{matrix}
\right\}
\Rightarrow
\left\{
\begin{matrix}
{{a\pm c}\equiv {b\pm d}\pmod {m}}
\\{{ac}\equiv {bd}\pmod {m}}
\end{matrix}
\right.
$$</p><h2 id=最大公约数>最大公约数</h2><h3 id=约数与-gcd-运算>约数与 gcd 运算</h3><p><strong>约数</strong>：能整除 $n$ 的正整数为 $n$ 的约数，所有这样的约数构成约数集合 $D_n=\{d|n, d\in\mathbb{N}^+\}$。</p><p><strong>最大公约数</strong>：两个数公共的最大约数就叫做两个数的最大公约数(<strong>G</strong>reatest <strong>C</strong>ommon <strong>D</strong>ivisor)，记作 $\gcd(a, b)$。例如，$\gcd(15,27)=3$。</p><p>在日常计算过程中，我们通常使用<a href="https://baike.baidu.com/item/%E7%9F%AD%E9%99%A4%E6%B3%95/3640958?fr=aladdin" target=_blank rel="noopener noreffer">短除法</a>来手动计算两个数的最大公约数。</p><h3 id=辗转相除法>辗转相除法</h3><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>算法描述<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>$\forall a,b\in \mathbb{Z}$，不失一般性，设 $a>b$，则 $\gcd(a, b) = \gcd(b, a{\ \text{mod}\ } b)$，不断迭代至其中较小的一项等于 $0$ 为止，此时的非 $0$ 项就是答案。</p><p>如果 $a{\ \text{mod}\ } b = r$，也可写作 $\gcd(a,b)=\gcd(b,r)$。</p></div></div></div><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>正确性证明<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>令 $a=kb+r$，我们需要证明 $\gcd(a,b)=\gcd(b,r)$。</p><p>从 $\gcd(a,b)$ 出发，我们有：</p><p>$$
\begin{aligned}
&\gcd(a,b)|a \land \gcd(a,b)|b
\\\mathllap{\implies} & \gcd(a,b) | (a-kb)
\\\mathllap{\implies} & \gcd(a,b) | r
\\\mathllap{\implies} & \gcd(a,b)\le\gcd(b,r)
\end{aligned}
$$</p><p>关于 $3\to4$ 的提示：考虑任意因子 $q|b, q|r$，易得 $q\le\gcd(b,r)$。第三步我们证明了 $\gcd(a,b)|r$，而我们自然有 $\gcd(a,b)|b$，则 $\gcd(a,b)\le\gcd(b,r)$，即为第四步。</p><p>从 $\gcd(b,r)$ 出发，我们有：</p><p>$$
\begin{aligned}
&\gcd(b,r)|b \land \gcd(b,r)|r
\\\mathllap{\implies} & \gcd(b,r) | (kb+r)
\\\mathllap{\implies} & \gcd(b,r) | a
\\\mathllap{\implies} & \gcd(b,r)\le\gcd(a,b)
\end{aligned}
$$</p><p>综合两式立即可得 $\gcd(a,b)=\gcd(b,r)$。</p><p>而易知 $|r|&lt;|b|$，我们总可在有限步后得到 $b{\ \text{mod}\ } r=0$，此时算法退出，我们得到的 $r$ 就是答案，得证。◼</p></div></div></div><h3 id=裴蜀定理>裴蜀定理</h3><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>定理<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>考虑 $\forall a,b\in\mathbb{Z}$，其中 $a, b$ 不同时为 $0$。那么：
$$
\exists x,y\in\mathbb{Z}, ax+by=\gcd(a,b)
$$
这样的数对 $(x, y)$ 称为裴蜀数，裴蜀数总有无穷多对。</div></div></div><p>裴蜀定理的证明与本文相关性不大，感兴趣的参考 ProofWiki 上的<a href=https://proofwiki.org/wiki/B%C3%A9zout%27s_Lemma target=_blank rel="noopener noreffer">证明</a>。</p><h3 id=质数与互质>质数与互质</h3><p><strong>质数</strong>：也叫素数。质数指大于 $1$ 且只能被自己和 $1$ 整除的自然数，常见的质数为 $2$, $3$, $5$, $7$ 和 $11$。不是质数的自然数被称为合数。</p><p><strong>互质</strong>：两个数 $a,b$ 互质即 $\gcd(a,b)=1$。</p><h3 id=同余除法第一原理>同余除法第一原理</h3><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>定理<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>考虑 $a,b,c,n\in\mathbb{Z}$，如果 $c$ 和 $n$ 互质，那么：</p><p>$$
{{ca}\equiv {cb}\pmod {n}}\implies{{a}\equiv {b}\pmod {n}}
$$</p></div></div></div><p>证明较为简单，留作习题。（提示：考虑 $ca=xn+r, cb=yn+r$，然后讨论 $n$ 整除性即可。）</p><h2 id=代数系统群环>代数系统、群、环</h2><h3 id=代数系统>代数系统</h3><p>考虑有一个元素集合 $A$（如自然数集合），我们定义某一种运算（通常为二元运算），如果任意在 $A$ 中的元素经过这种运算之后的结果仍然在 $A$ 内，我们就称这个集合 $A$ 关于此运算<strong>封闭</strong>。</p><p>由一个元素集合 $A$ 和一系列在 $A$ 上封闭的运算组成的系统就叫做<strong>代数系统</strong>（也叫做代数结构）。</p><div class="details admonition example open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ol fa-fw" aria-hidden=true></i>示例<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>一个简单的例子为实数和实数四则运算，它们构成了一个代数系统。</div></div></div><h3 id=半群和幺半群>半群和幺半群</h3><p>考虑<strong>代数系统</strong> $(S,\times)$，如果满足：</p><ul><li>结合律：$\forall a,b,c\in S, (a\times b)\times c=a\times(b\times c)$。</li></ul><p>那么我们称 $(S, \times)$ 是一个半群。</p><p>考虑<strong>半群</strong> $(M, \times)$，如果满足：</p><ul><li>存在单位元：$\exists e\in M$ 使得 $\forall a\in M, a\times e=e\times a=a$。</li></ul><p>那么我们称 $(M,\times)$ 是一个幺半群。</p><div class="details admonition example open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ol fa-fw" aria-hidden=true></i>示例<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>一个常见的半群为整数加法半群，其中 $S=\mathbb{Z}, \times=+$。由于 $a+0=0+a=a$，则单位元 $0$，这个半群同样为幺半群。</div></div></div><h3 id=群和阿贝尔群>群和阿贝尔群</h3><p>考虑<strong>幺半群</strong> $(G, \times)$，如果满足：</p><ul><li>存在逆元：$\forall a\in G$ 总满足 $\exists x\in G, a\times x=x\times a=e$，通常也记 $x=a^{-1}$。</li></ul><p>那么我们称 $(G,\times)$ 是一个群。</p><p>考虑<strong>群</strong> $(A, \times)$，如果满足：</p><ul><li>交换律：$\forall a,b\in A, a\times b=b\times a$。</li></ul><p>那么我们称 $(A, \times)$ 是一个阿贝尔群或交换群。</p><div class="details admonition example open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ol fa-fw" aria-hidden=true></i>示例<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>一个常见的群为整数加法群，其中 $G=\mathbb{Z}, \times=+$，容易验证单位元为 $0$，$a$ 的逆元为 $-a$。由于加法满足交换律，这个群同样为阿贝尔群。</div></div></div><h3 id=环>环</h3><p>考虑代数系统 $(R, +, \times)$，如果满足：</p><ul><li>$(R, +)$ 为阿贝尔群。</li><li>$(R, \times)$ 为半群。</li><li>$\times$ 关于 $+$ 运算可分配：<ul><li>$\forall a,b,c\in R, a\times(b+c)=a\times b+a\times c$；</li><li>$\forall a,b,c\in R, (a+b)\times c=a\times c+b\times c$。</li></ul></li></ul><p>那么我们称 $(R, +, \times)$ 为环。</p><div class="details admonition example open"><div class="details-summary admonition-title"><i class="icon fas fa-list-ol fa-fw" aria-hidden=true></i>示例<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>一个常见的环即整数环，其中 $R=\mathbb{Z}, +=+, \times=\times$。易于验证 $(\mathbb{Z}, +)$ 为阿贝尔群，$(\mathbb{Z},\times)$ 为半群且 $\times$ 关于 $+$ 可分配。</div></div></div><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fas fa-pencil-alt fa-fw" aria-hidden=true></i>注意<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content>由于历史原因，有的定义中认为第二条中 $(R, \times)$ 应该为幺半群才能构成环。这两种定义的选择应该根据上下文确定。</div></div></div><h3 id=整数模-n-乘法群>整数模 $n$ 乘法群</h3><p>我们定义整数模 $n$ 乘法为 $a\cdot b = a\times b{\ \text{mod}\ } n$。</p><p>考虑所有和 $n$ 互质的小于 $n$ 的整数集合 $\mathbb{Z}/n$，那么 $(\mathbb{Z}/n, \cdot)$ 称作整数模 $n$ 乘法群，我们通常记作 $(\mathbb{Z}/n\mathbb{Z})^\times$。</p><p>这个乘法群同样可以被描述为：</p><ul><li>原始模 $n$ 同余类：由所有与 $n$ 互质的同余类构成的集合。</li><li>模 $n$ 乘法环的单位群。</li></ul><p>我们来证明 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}$ 构成一个群。</p><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>证明<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li>封闭性：$\forall a,b\in {(\mathbb{Z}/{n}\mathbb{Z})^\times}, \gcd(a,n) = 1, \gcd(b,n)=1\implies\gcd(ab,n)=1$。由于 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}$ 包含了所有模 $n$ 且与 $n$ 互质的数，则 $ab\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$，得证。</li><li>交换律：由取余运算保持乘法运算律立即可证。</li><li>单位元：选择 $e=1\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$，易得 $\forall a\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}, 1\cdot a\equiv a\cdot1\equiv a\pmod n$，得证。</li><li>逆元：任选 $a\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$，我们有 $\gcd(a,n)=1$，则根据裴蜀定理知 $ax+yn=1$ 有解，则可得 $1{\ \text{mod}\ } n=ax\implies{{ax}\equiv {1}\pmod {n}}$；而 $ax+yn=1$ 可以得出 $\gcd(x,n)=1$，则 $x\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$。所以 $x$ 为 $a$ 的一个逆元。</li></ul><p>则整数模 $n$ 乘法构成一个群，得证。◼</div></div></div><p>特别的，对于质数 $p$，根据定义我们可得 ${(\mathbb{Z}/{p}\mathbb{Z})^\times}$ 为小于 $p$ 的所有正整数。</p><h2 id=欧拉函数和欧拉定理>欧拉函数和欧拉定理</h2><h3 id=欧拉函数>欧拉函数</h3><p>我们定义欧拉函数 $\phi(n)$ 为对于正整数 $n$，小于 $n$ 且与 $n$ 互质的数的数目。从定义可知，$|{(\mathbb{Z}/{n}\mathbb{Z})^\times}|=\phi(n)$。</p><p>欧拉函数有以下两个性质：</p><ul><li>对于质数 $p$，有 $\phi(p)=p-1$；</li><li>欧拉函数为积性函数，即对于互质的整数 $a$ 和 $b$，$\phi(ab)=\phi(a)\phi(b)$。</li></ul><p>欧拉函数的求法和更多性质不在本文的范围内，感兴趣的可以看 Wolfram Mathworld 上的<a href=https://mathworld.wolfram.com/TotientFunction.html target=_blank rel="noopener noreffer">介绍</a>。</p><h3 id=欧拉定理>欧拉定理</h3><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>定理<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>对于互质整数 $a, n$，下面同余式恒成立：</p><p>$$
{{a^{\phi(n)}}\equiv {1}\pmod {n}}
$$</p><p>如 $n$ 为一个质数 $p$，有：</p><p>$$
{{a^{p-1}}\equiv {1}\pmod {p}}
$$</p><p>上式即为<strong>费马小定理</strong>，可以看出来是欧拉定理的一个特殊形式。</p></div></div></div><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>证明<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>考虑 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}=\{p_1,\cdots,p_{\phi(n)}\}$，我们先证明 $a{(\mathbb{Z}/{n}\mathbb{Z})^\times}=\{ap_1,\cdots,ap_{\phi(n)}\}$ 在模 $n$ 意义下等于 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}$。</p><ul><li>元素是唯一的：假设存在 ${{ap_i}\equiv {ap_j}\pmod {n}}$，那么自然有 $n|a(p_i-p_j)$，由于 $a$ 以及 $p_i-p_j$ 均和 $n$ 互质，产生矛盾，即不存在 ${{ap_i}\equiv {ap_j}\pmod {n}}$，得证。</li><li>元素均在 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}$ 内：由于 $a$ 和 $n$ 互质，$a\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$，又由于 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}$ 是阿贝尔群，关于乘法运算封闭，则 $\forall p\in{(\mathbb{Z}/{n}\mathbb{Z})^\times},ap\in{(\mathbb{Z}/{n}\mathbb{Z})^\times}$。</li></ul><p>那立即可得 $|a{(\mathbb{Z}/{n}\mathbb{Z})^\times}|=\phi(n)$，且元素两两不同，两个集合相等即证。</p><p>由于 ${(\mathbb{Z}/{n}\mathbb{Z})^\times}=a{(\mathbb{Z}/{n}\mathbb{Z})^\times}$，我们把两个集合的元素各求一个积，易得：</p><p>$$
\begin{aligned}
\prod_{i=1}^{\phi(n)}p_i&\equiv\prod_{i=1}^{\phi(n)}ap_i\pmod n
\\\prod_{i=1}^{\phi(n)}p_i&\equiv a^{\phi(i)}\prod_{i=1}^{\phi(n)}p_i\pmod n
\\\end{aligned}
$$</p><p>由于 $p_i$ 均和 $n$ 互质，可知 $\prod_{i=1}^{\phi(n)}p_i$ 也与 $n$ 互质。应用同余除法第一原理，立即可得 ${{a^{\phi(i)}}\equiv {1}\pmod {n}}$，得证。◼</p></div></div></div><h2 id=rsa>RSA</h2><h3 id=rsa-简介>RSA 简介</h3><blockquote><p>RSA 加密演算法是一种非对称加密演算法，在公开密钥加密和电子商业中被广泛使用。RSA 是 1977 年由罗纳德·李维斯特（Ron Rivest）、阿迪·萨莫尔（Adi Shamir）和伦纳德·阿德曼（Leonard Adleman）一起提出的。当时他们三人都在麻省理工学院工作。RSA 就是他们三人姓氏开头字母拼在一起组成的。</p></blockquote><h3 id=rsa-算法>RSA 算法</h3><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fas fa-info-circle fa-fw" aria-hidden=true></i>算法描述<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li>密钥对产生<ol><li>任选两个<strong>足够大</strong>的质数 $p$ 和 $q$，计算 $n=pq$。</li><li>计算 $\phi(n)=\phi(p)\times\phi(q)=(p-1)(q-1)$。丢弃 $p$ 和 $q$。</li><li>选择一个 $e$ 满足 $1&lt;e&lt;\phi(n)$ 且 $\gcd(e,\phi(n))=1$，将 $(n, e)$ 作为公钥。</li><li>选择一个 $e$ 的逆元 $d$ 满足 ${{ed}\equiv {1}\pmod {\phi(n)}}$，将 $(n, d)$ 作为私钥。</li></ol></li><li>加密：将信息编码为 $m$，其中 $0&lt;m&lt;n$。 计算 $c=m^e{\ \text{mod}\ } n$，$c$ 即为加密后的信息。</li><li>解密：计算 $m=c^d{\ \text{mod}\ } n$, $m$ 被还原。</li></ul></div></div></div><div class="details admonition tip open"><div class="details-summary admonition-title"><i class="icon fas fa-lightbulb fa-fw" aria-hidden=true></i>正确性证明<i class="details-icon fas fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><p>关于加解密的正确性我们需要证明 ${{m^{ed}}\equiv {m}\pmod {n}}$。</p><ul><li><p>$m$ 和 $n$ 互质</p><p>由于 ${{ed}\equiv {1}\pmod {\phi(n)}}$，则 $ed=k\phi(n)+1$，那么 $m^{ed}=m^{k\phi(n)+1}=m^{k\phi(n)}\cdot m$。由欧拉定理可知 ${{m^{\phi(n)}}\equiv {1}\pmod {n}}$，那么有 ${{m^{k\phi(n)}\cdot m}\equiv {m}\pmod {n}}$，得证。</p></li><li><p>$m$ 和 $n$ 不互质</p><p>考察 ${{m^{ed}}\equiv {m}\pmod {n}}$，对 $n$ 分解因子有 ${{m^{ed}}\equiv {m}\pmod {p}}$ 和 ${{m^{ed}}\equiv {m}\pmod {q}}$。我们现在要证明这两个式子。</p><p>由于 $p, q$ 均为质数，而 $m$ 和 $n$ 不互质，则 $m$ 必为其中的一个整数倍。不失一般性，令 $m=kp$，则第一个式子立即得证。由于 $m=kp&lt;n=pq$，则 $k&lt;p$，可知 $k\in{(\mathbb{Z}/{p}\mathbb{Z})^\times}$，那么立即有 $\gcd(kp, q)=1$。</p><p>现在我们来证明第二个式子。由于 $kp$ 和 $q$ 一定互质，又有 ${{ed}\equiv {1}\pmod {\phi(n)}}\implies ed=h(p-1)(q-1)+1$，则：</p><p>$$
\begin{aligned}
m^{ed}&\equiv m^{h(p-1)(q-1)+1}\pmod q
\\&\equiv (m^{q-1})^{h(p-1)}\cdot m\pmod q
\\&\equiv (m^{\phi(q)})^{h(p-1)}\cdot m\pmod q
\\&\equiv m\pmod q
\end{aligned}
$$</p><p>则原式得证。</p></li></ul><p>所以 ${{m^{ed}}\equiv {m}\pmod {n}}$ 恒成立，正确性得证。◼</p></div></div></div><h3 id=安全性>安全性</h3><p>如果想要计算出 $d$，我们需要先因式分解出 $n=pq$，然后计算同余方程 ${{de}\equiv {1}\pmod {(p-1)(q-1)}}$。而目前并没有任何办法证明是否存在一种多项式时间的因式分解算法，因此只需要 $n$ 选的足够大，我们就可以认为 RSA 算法是安全的。</p><h2 id=还有什么>还有什么</h2><ul><li><p>朴素的乘方操作需要 $\mathcal{O}(n)$ 的时间，如果 $e$ 和 $d$ 计算出来很大的话需要很长的时间计算。有没有更快的办法？</p></li><li><p>原始论文中，$\phi(n)$ 的选择实在是太大了，很多时候我们都不需要这样大的数，在实现中，通常使用 $\lambda(n)$ 来优化。$\lambda(x)$ 是<a href=https://mathworld.wolfram.com/CarmichaelFunction.html target=_blank rel="noopener noreffer">卡迈克尔函数</a>，为什么它能兼容原始论文版本呢？</p></li><li><p>在实际实现中，我们也使用<a href=https://mathworld.wolfram.com/ChineseRemainderTheorem.html target=_blank rel="noopener noreffer">中国剩余定理</a>来加速计算过程。这是怎么做到的？</p></li></ul></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span>更新于 2022-10-11</span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://blog.lxdlam.com/post/42be77f6/ data-title="From gcd to RSA" data-hashtags=数学,学习笔记><i class="fab fa-twitter fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://blog.lxdlam.com/post/42be77f6/ data-hashtag=数学><i class="fab fa-facebook-square fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Instapaper" data-sharer=instapaper data-url=https://blog.lxdlam.com/post/42be77f6/ data-title="From gcd to RSA" data-description><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.3.0/icons/instapaper.svg aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Pocket" data-sharer=pocket data-url=https://blog.lxdlam.com/post/42be77f6/><i class="fab fa-get-pocket fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://blog.lxdlam.com/post/42be77f6/ data-title="From gcd to RSA"><i class="fab fa-weibo fa-fw" aria-hidden=true></i></a><a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://blog.lxdlam.com/post/42be77f6/ data-title="From gcd to RSA"><i class="fab fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fas fa-tags fa-fw" aria-hidden=true></i>&nbsp;<a href=/tags/%E6%95%B0%E5%AD%A6/>数学</a>,&nbsp;<a href=/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/>学习笔记</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/post/a31ff541/ class=prev rel=prev title="最近做的题 ver 2019.12"><i class="fas fa-angle-left fa-fw" aria-hidden=true></i>最近做的题 ver 2019.12</a>
<a href=/post/1b1fad8c/ class=next rel=next title="拥抱 IPFS">拥抱 IPFS<i class="fas fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article></div></main><footer class=footer><div class=footer-container><div class=footer-line>由 <a href=https://gohugo.io/ target=_blank rel="noopener noreffer" title="Hugo 0.109.0">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/dillonzq/LoveIt target=_blank rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden=true></i> LoveIt</a></div><div class=footer-line itemscope itemtype=http://schema.org/CreativeWork><i class="far fa-copyright fa-fw" aria-hidden=true></i><span itemprop=copyrightYear>2017 - 2023</span><span class=author itemprop=copyrightHolder>&nbsp;<a href=https://blog.lxdlam.com target=_blank>Ramen</a></span>&nbsp;|&nbsp;<span class=license><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>署名-非商业性使用-相同方式共享 4.0 国际</a></span></div></div></footer></div><div id=fixed-buttons><a href=# id=back-to-top class=fixed-button title=回到顶部><i class="fas fa-arrow-up fa-fw" aria-hidden=true></i>
</a><a href=# id=view-comments class=fixed-button title=查看评论><i class="fas fa-comment fa-fw" aria-hidden=true></i></a></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css><script type=text/javascript src=https://cdn.jsdelivr.net/npm/lazysizes@5.3.2/lazysizes.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/auto-render.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/copy-tex.min.js></script><script type=text/javascript src=https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/contrib/mhchem.min.js></script><script type=text/javascript>window.config={code:{copyTitle:"复制到剪贴板",maxShownLines:10},comment:{},math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1}}</script><script type=text/javascript src=/js/theme.min.js></script><script type=text/javascript>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-92306989-1",{anonymize_ip:!0})</script><script type=text/javascript src="https://www.googletagmanager.com/gtag/js?id=UA-92306989-1" async></script></body></html>